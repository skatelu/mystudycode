/**
 * KJDP4.0.0
 * Copyright (c) 2009-2016 www.szkingdom.com. All rights reserved.
 */
define("lib/core",["lib/core/ajax","lib/core/cache","lib/core/sm4","lib/core/uri","lib/core/utils","lib/core/aes","lib/core/base64","lib/core/console","lib/core/date","lib/core/number","lib/core/parser","lib/core/view","lib/core/pushlet","lib/core/param","lib/core/dict"],function(a,b){!String.prototype.startsWith&&(String.prototype.startsWith=function(a){return!a||!a.length||a.length>this.length?!1:this.substr(0,a.length)===a}),!String.prototype.endsWith&&(String.prototype.endsWith=function(a){return!a||!a.length||a.length>this.length?!1:this.substring(this.length-a.length)===a}),!String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")}),Function.prototype.extend=function(a){$.extend(this.prototype,a)},Function.prototype.inherit=function(a){function b(){}if(_.isFunction(a)){b.prototype=a.prototype;var c=this.prototype.constructor;this.prototype=new b,this.prototype.constructor=c,this.prototype.__proto__||(this.prototype.__proto__=a.prototype)}},window.onerror=function(a,b,c,d,e){window.setTimeout(function(){try{ajax.post({service:"P0000049",URL:b,LINE:c,COL:d||window.event&&window.event.errorCharacter||0,MESSAGE:a,STACK:e&&(e.stack||e.stacktrace)||""},{noProcess:!0})}catch(f){console.error(f)}},0)},b.ajax=_.clone(a("lib/core/ajax")),b.base64=a("lib/core/base64"),b.cache=a("lib/core/cache"),b.console=a("lib/core/console"),b.date=a("lib/core/date"),b.number=a("lib/core/number"),b.parser=a("lib/core/parser"),b.pushlet=a("lib/core/pushlet"),b.uri=a("lib/core/uri"),b.utils=a("lib/core/utils"),b.param=a("lib/core/param"),b.dict=a("lib/core/dict");var c=b.ajax.post;b.ajax.post=function(a,b){return c(a,$.extend({},b,{async:!0,refreshEncKey:!1}))}}),define("lib/core/ajax",["lib/core/cache","lib/core/sm4","lib/core/uri","lib/core/utils","lib/core/aes"],function(a,b,c){function d(a,b){if(!a)throw"参数不合法，请检查参数！";var c=[];c=a.req?$.isArray(a.req)?a.req:[a.req]:$.isArray(a)?a:[a],this[j.expando]={req:c,config:b||{}},this.length=c.length}function e(a){var b,c;if(a.ANS_COMM_DATA&&a.ANS_MSG_HDR)b=a.ANS_MSG_HDR,c=a.ANS_COMM_DATA;else if(a.MSG_CODE){a.MSG_CODE=a.MSG_CODE||"0",a.MSG_TEXT=a.MSG_TEXT||"业务运行成功！",b={MSG_CODE:a.MSG_CODE,MSG_TEXT:a.MSG_TEXT};var c=[];_.contains(e.SUCCESS_CODES,a.MSG_CODE)&&c.push([a])}$.extend(this,c),this[j.expando]={MSG_HDR:b},this.length=c.length}function f(a){var b=this;a.ANSWERS?_.each(a.ANSWERS,function(a){b.push(new e(a))}):a instanceof e&&b.push(a)}var g=a("lib/core/cache"),h=a("lib/core/sm4"),i=a("lib/core/uri"),j=a("lib/core/utils");b.DATA_TYPE_JSON="json",b.DATA_TYPE_TEXT="text",d.extend({get:function(a){return this[a]},push:Array.prototype.push,sort:[].sort,splice:[].splice,getConfig:function(){return this[j.expando].config},getServcies:function(){return _.chain(this[j.expando].req).map(function(a){return a.service}).value()},stringify:function(){return JSON.stringify({REQUESTS:_.map(this[j.expando].req,function(a){return{REQ_MSG_HDR:{},REQ_COMM_DATA:a}})})}}),e.SUCCESS_CODES=["0","100"],e.extend({getData:function(){for(var a=[],b=0;b<this.length;b++)a.push(this[b]);return a},getHead:function(){return this[j.expando].MSG_HDR},isSuccess:function(a){return _.contains(e.SUCCESS_CODES.concat(_.isString(a)?a.split(","):_.isArray(a)?a:[]),this.getMsgCode())},isSessionTimeout:function(){return"10000"===this.getMsgCode()},getMsgCode:function(){return this[j.expando].MSG_HDR.MSG_CODE},getMsgText:function(){return this[j.expando].MSG_HDR.MSG_TEXT},getRunTimes:function(){return this[j.expando].MSG_HDR.RUN_TIMES||"0"},getDataRow:function(){return this[0]&&this[0].length?this[0][0]:{}},getDataRows:function(){return this[0]||[]}}),f.extend({push:Array.prototype.push,sort:[].sort,splice:[].splice,get:function(a){return this[a]},isSuccess:function(){return _.every(this,function(a){return a.isSuccess()})},getErrorResult:function(a){return _.find(this,function(b){return!b.isSuccess(a)})}}),b.ajax=function(a){var c=$.Deferred();return $.ajax($.extend({timeout:a.timeout||12e4,type:a.type||"POST",dataType:a.dataType||b.DATA_TYPE_JSON,contentType:"text/plain; charset=utf-8"},a)).then(function(a,b,d){c.resolveWith(this,[a,{readyState:d.readyState,status:d.status,statusText:d.statusText}])},function(a,b,d){c.rejectWith(this,[{readyState:a.readyState,status:a.status,statusText:b,errorThrown:"OK"===d?a.status+"":d||"未知错误"}])}),c.promise()},b.getEncryptKey=function(){var a=j.md5("encrypt"+c.id);return function(c){if(!c&&g.containsKey(a))return g.getData(a);var d="";return b.ajax({async:!1,dataType:b.DATA_TYPE_TEXT,url:i.buildUrl(i.resolve("kjdp_encryptkey#"),{t:$.now()})}).then(function(b){b&&g.setData(a,d=b+"")}),d}}(),b.login=function(a){if(!a)throw"登录参数不合法,请检查参数.";if(!a.OP_CODE)throw"必要参数[OP_CODE]不能为空.";if(!a.OP_PASS)throw"必要参数[OP_PASS]不能为空.";return a.OP_PASS=j.encrypt(a.OP_PASS,a.OP_CODE),b.post($.extend({},a,{service:"P0000001"}),{noProcess:!0,refreshEncKey:!0})},b.session=function(){var a=j.md5("session"+c.id);return function(){if(g.containsKey(a))return g.getData(a);var c=null;return b.post({service:"P0000002"},{async:!1}).then(function(b){c=b.getDataRow(),_.isEmpty(c)||g.setData(a,c)}),c}}(),b.isLogin=function(){return!_.isEmpty(b.session())},b.logout=function(){b.post({service:"P0000003"},{async:!1}),g.remove(j.md5("encrypt"+c.id))},b.showSessionTimeoutPrompt=function(){var a=!1;return function(){a||(a=!0,top.alert("您的服务器会话已过期，请重新登录！",function(){top.location.reload()}))}}(),b.post=function(a,c){var g=$.Deferred(),j=new d(a.req?a.req:a,a.req?_.omit(a,"req"):c||{}),k=j.getConfig(),l=b.getEncryptKey(k.refreshEncKey);if(!l){var m=new e({MSG_CODE:"8888888888",MSG_TEXT:"获取encryptKey失败."});return g.rejectWith(this,[m,new f(m)]),g.promise()}return b.ajax({async:!1!==k.async,type:"POST",dataType:"JSON",contentType:"text/plain;charset=utf-8",processData:!1,timeout:k.timeout||3e5,url:i.buildUrl(i.resolve("kjdp_ajax#"),{services:j.getServcies().join(","),t:$.now()}),data:h.encrypt(j.stringify(),l)}).then(function(a){var c=new f(a),d=c[0];if(k.noProcess||c.isSuccess(k.extMsgCode))g.resolveWith(this,[d,c]);else{var e=c.getErrorResult();e.isSessionTimeout()?b.showSessionTimeoutPrompt():top.alert(e.getMsgText(),alert.ERROR),g.rejectWith(this,[d,c])}},function(a){!1!==k.showErrorPrompt&&("timeout"===a.statusText&&top.alert("请求超时，请检查网络！",alert.ERROR),"error"===a.statusText&&a.errorThrown&&top.alert("服务器发生了错误，错误信息："+a.errorThrown,alert.ERROR)),g.rejectWith(this,[new e({MSG_CODE:"-9"+a.readyState+a.status,MSG_TEXT:a.statusText})])}),g.promise()},b.decryptPost=function(a){return h.decrypt(a,b.getEncryptKey())}}),define("lib/core/cache",[],function(a,b){function c(a){return a instanceof seajs.Module?a.id:a}var d=top.window.kjdpCacheObj=top.window.kjdpCacheObj||{};b.containsKey=function(a){return null!=b.getData(a)},b.setData=function(a,b){d[c(a)]=b},b.getData=function(a){return d[c(a)]},b.remove=function(a){delete d[c(a)]},b.setLocalStorage=function(a,d){window.localStorage?window.localStorage.setItem(c(a),d):b.setData(a,d)},b.getLocalStorage=function(a){return window.localStorage?window.localStorage.getItem(c(a)):b.getData(a)},b.removeLocalStorage=function(a){window.localStorage?a?window.localStorage.removeItem(c(a)):window.localStorage.clear():b.remove(a)}}),define("lib/core/sm4",[],function(a,b,c){function d(a){var b,c,d=new Array;b=a.length;for(var e=0;b>e;e++)c=a.charCodeAt(e),c>=65536&&1114111>=c?(d.push(c>>18&7|240),d.push(c>>12&63|128),d.push(c>>6&63|128),d.push(63&c|128)):c>=2048&&65535>=c?(d.push(c>>12&15|224),d.push(c>>6&63|128),d.push(63&c|128)):c>=128&&2047>=c?(d.push(c>>6&31|192),d.push(63&c|128)):d.push(255&c);return d}function e(a){if("string"==typeof a)return a;var b="",c=a;try{for(var d=0;d<c.length;d++){var e=c[d].toString(2),f=e.match(/^1+?(?=0)/);if(f&&8==e.length){for(var g=f[0].length,h=c[d].toString(2).slice(7-g),i=1;g>i;i++)h+=c[i+d].toString(2).slice(2);b+=String.fromCharCode(parseInt(h,2)),d+=g-1}else b+=String.fromCharCode(c[d])}return b}catch(j){return""}}function f(a){for(var b=d(a.input),c=d(a.key),e=[],f=0;f<b.length;f+=16)e=e.concat(y({source:b.slice(f,f+16),key:c},l));return j.fromByteArray(e)}function g(a){for(var b=j.toByteArray(a.input),c=d(a.key),f=[],g=0;g<b.length;g+=16)f=f.concat(y({source:b.slice(g,g+16),key:c},m));return e(f).replace(/\0+$/g,"")}function h(a,b){return f({input:a,key:b||k})}function i(a,b){return g({input:a,key:b||k})}var j=function(){return function b(c,d,e){function f(h,i){if(!d[h]){if(!c[h]){var j="function"==typeof a&&a;if(!i&&j)return j(h,!0);if(g)return g(h,!0);var k=new Error("Cannot find module '"+h+"'");throw k.code="MODULE_NOT_FOUND",k}var l=d[h]={exports:{}};c[h][0].call(l.exports,function(a){var b=c[h][1][a];return f(b?b:a)},l,l.exports,b,c,d,e)}return d[h].exports}for(var g="function"==typeof a&&a,h=0;h<e.length;h++)f(e[h]);return f}({"/":[function(a,b,c){function d(a){var b=a.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===a[b-2]?2:"="===a[b-1]?1:0}function e(a){return 3*a.length/4-d(a)}function f(a){var b,c,e,f,g,h=a.length;f=d(a),g=new l(3*h/4-f),c=f>0?h-4:h;var i=0;for(b=0;c>b;b+=4)e=k[a.charCodeAt(b)]<<18|k[a.charCodeAt(b+1)]<<12|k[a.charCodeAt(b+2)]<<6|k[a.charCodeAt(b+3)],g[i++]=e>>16&255,g[i++]=e>>8&255,g[i++]=255&e;return 2===f?(e=k[a.charCodeAt(b)]<<2|k[a.charCodeAt(b+1)]>>4,g[i++]=255&e):1===f&&(e=k[a.charCodeAt(b)]<<10|k[a.charCodeAt(b+1)]<<4|k[a.charCodeAt(b+2)]>>2,g[i++]=e>>8&255,g[i++]=255&e),g}function g(a){return j[a>>18&63]+j[a>>12&63]+j[a>>6&63]+j[63&a]}function h(a,b,c){for(var d,e=[],f=b;c>f;f+=3)d=(a[f]<<16)+(a[f+1]<<8)+a[f+2],e.push(g(d));return e.join("")}function i(a){for(var b,c=a.length,d=c%3,e="",f=[],g=16383,i=0,k=c-d;k>i;i+=g)f.push(h(a,i,i+g>k?k:i+g));return 1===d?(b=a[c-1],e+=j[b>>2],e+=j[b<<4&63],e+="=="):2===d&&(b=(a[c-2]<<8)+a[c-1],e+=j[b>>10],e+=j[b>>4&63],e+=j[b<<2&63],e+="="),f.push(e),f.join("")}c.byteLength=e,c.toByteArray=f,c.fromByteArray=i;for(var j=[],k=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,o=m.length;o>n;++n)j[n]=m[n],k[m.charCodeAt(n)]=n;k["-".charCodeAt(0)]=62,k["_".charCodeAt(0)]=63},{}]},{},[])("/")}(),k="We@53&es&esT*7%s",l=1,m=0,n=32,o=16,p=[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72],q=[462357,472066609,943670861,1415275113,1886879364,2358483617,2830087869,3301692121,3773296373,4228057617,404694572,876298825,1347903076,1819507329,2291111581,2762715833,3234320085,3705924337,4177462796,337322537,808926788,1280531041,1752135293,2223739545,2695343797,3166948049,3638552300,4110090761,269950500,741554753,1213159005,1684763257],r=function(a,b){return a<<b|a>>>32-b},s=function(a){return(255&p[a>>>24&255])<<24|(255&p[a>>>16&255])<<16|(255&p[a>>>8&255])<<8|255&p[255&a]},t=function(a){return a^r(a,2)^r(a,10)^r(a,18)^r(a,24)},u=function(a){return a^r(a,13)^r(a,23)},v=function(a,b,c){var d,e;x=new Array(4),tmp=new Array(4);for(var f=0;4>f;f++)tmp[0]=255&a[0+4*f],tmp[1]=255&a[1+4*f],tmp[2]=255&a[2+4*f],tmp[3]=255&a[3+4*f],x[f]=tmp[0]<<24|tmp[1]<<16|tmp[2]<<8|tmp[3];for(d=0;32>d;d+=4)e=x[1]^x[2]^x[3]^c[d+0],e=s(e),x[0]=x[0]^t(e),e=x[2]^x[3]^x[0]^c[d+1],e=s(e),x[1]=x[1]^t(e),e=x[3]^x[0]^x[1]^c[d+2],e=s(e),x[2]=x[2]^t(e),e=x[0]^x[1]^x[2]^c[d+3],e=s(e),x[3]=x[3]^t(e);for(var g=0;16>g;g+=4)b[g]=x[3-g/4]>>>24&255,b[g+1]=x[3-g/4]>>>16&255,b[g+2]=x[3-g/4]>>>8&255,b[g+3]=255&x[3-g/4]},w=function(a,b,c){for(var d,e,f=new Array,g=new Array(4),h=0;4>h;h++)g[0]=255&a[0+4*h],g[1]=255&a[1+4*h],g[2]=255&a[2+4*h],g[3]=255&a[3+4*h],f[h]=g[0]<<24|g[1]<<16|g[2]<<8|g[3];for(f[0]^=2746333894,f[1]^=1453994832,f[2]^=1736282519,f[3]^=2993693404,d=0;32>d;d+=4)e=f[1]^f[2]^f[3]^q[d+0],e=s(e),b[d+0]=f[0]^=u(e),e=f[2]^f[3]^f[0]^q[d+1],e=s(e),b[d+1]=f[1]^=u(e),e=f[3]^f[0]^f[1]^q[d+2],e=s(e),b[d+2]=f[2]^=u(e),e=f[0]^f[1]^f[2]^q[d+3],e=s(e),b[d+3]=f[3]^=u(e);if(c===m)for(d=0;16>d;d++)e=b[d],b[d]=b[31-d],b[31-d]=e},y=function(a,b){point=0,inLen=16;var c=new Array(n);w(a.key,c,b);for(var d=new Array(16),e=new Array(16),f=[];inLen>=o;)d=a.source.slice(point,point+16),v(d,e,c),f=f.concat(e),inLen-=o,point+=o;return f};c.exports={decrypt:i,encrypt:h}}),define("lib/core/uri",[],function(a,b){b.resolve=seajs.resolve,b.parseUrl=function(a){var b=document.createElement("a");return b.href=a=a||window.location.href,{source:a,protocol:b.protocol.replace(":",""),host:b.hostname,port:"0"==b.port||""==b.port?80:b.port,query:b.search,params:function(){for(var a,c={},d=b.search.replace(/^\?/,"").split("&"),e=d.length,f=0;e>f;f++)d[f]&&(a=d[f].split("="),c[a[0]]=decodeURIComponent(a[1]));return c}(),file:(b.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:b.hash.replace("#",""),path:b.pathname.replace(/^([^\/])/,"/$1"),relative:(b.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:b.pathname.replace(/^\//,"").split("/")}},b.getUrlParam=function(a){return b.parseUrl(a).params},b.urlParam=b.getUrlParam(),b.getHash=function(a){return b.parseUrl(a).hash},b.buildUrl=function(a,c,d){if(!a)return"";var e=b.parseUrl(a),f=function(){return _.isString(d)?d?"#"+d:"":e.hash?"#"+e.hash:""}(),g=function(){var a=$.extend({},e.params,c);return $.isEmptyObject(a)?"":"?"+b.buildQueryString(a)}();return a.replace(/(\?|\#).*/,"")+g+f},b.buildQueryString=function(a){return _.chain(a).map(function(a,b){return b+"="+encodeURIComponent(a)}).value().join("&")}}),define("lib/core/utils",["lib/core/aes","lib/core/sm4"],function(require,exports,module){exports.expando="kjdp_"+(kjdp.version+Math.random()).replace(/\D/g,""),exports.parse=JSON.parse,exports.stringify=JSON.stringify,exports.slice=function(a,b,c){return Array.prototype.slice.call(a,b,c)},exports.eval=function(data,scopeObj){if(!_.isString(data)||!data)return data;var tmp;with(scopeObj||{})try{tmp=eval("("+data+")")}catch(ex){tmp=data}return tmp},exports.escape=function(a){return $("<div></div>").text($.trim(a+"")).html().replace(/\"/g,"&quot;").replace(/\'/g,"&apos;")},exports.unescape=function(a){return $("<div></div>").html($.trim(a+"")).text()},exports.getCharLength=function(a){return _.isString(a)?a.replace(/[^\x00-\xff]/g,"**").length:0};var aes=require("lib/core/aes");exports.md5=aes.md5;var sm4=require("lib/core/sm4");exports.encrypt=sm4.encrypt,exports.decrypt=sm4.decrypt}),define("lib/core/aes",[],function(a,b){function c(a){if(!a)return e;a=a.replace(/[^\x00-\xff]/g,"00");var b=a.length;if(16===b)return a;if(b>16)return a.substring(0,16);for(var c=0;16-b>c;c++)a="0"+a;return a}var d=d||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),h=c.enc={},i=h.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=e/(4*f),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*f,e=a.min(4*b,e),b){for(var i=0;b>i;i+=f)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new g.init(i,e)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}});var m=c.algo={};return c}(Math);!function(){var a=d,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp(),a=[];for(var e=0;c>e;e+=3)for(var f=(b[e>>>2]>>>24-8*(e%4)&255)<<16|(b[e+1>>>2]>>>24-8*((e+1)%4)&255)<<8|b[e+2>>>2]>>>24-8*((e+2)%4)&255,g=0;4>g&&c>e+.75*g;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var c=a.length,d=this._map,e=d.charAt(64);e&&(e=a.indexOf(e),-1!=e&&(c=e));for(var e=[],f=0,g=0;c>g;g++)if(g%4){var h=d.indexOf(a.charAt(g-1))<<2*(g%4),i=d.indexOf(a.charAt(g))>>>6-2*(g%4);e[f>>>2]|=(h|i)<<24-8*(f%4),f++}return b.create(e,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(a){function b(a,b,c,d,e,f,g){return a=a+(b&c|~b&d)+e+g,(a<<f|a>>>32-f)+b}function c(a,b,c,d,e,f,g){return a=a+(b&d|c&~d)+e+g,(a<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){return a=a+(b^c^d)+e+g,(a<<f|a>>>32-f)+b}function f(a,b,c,d,e,f,g){return a=a+(c^(b|~d))+e+g,(a<<f|a>>>32-f)+b}for(var g=d,h=g.lib,i=h.WordArray,j=h.Hasher,h=g.algo,k=[],l=0;64>l;l++)k[l]=4294967296*a.abs(a.sin(l+1))|0;h=h.MD5=j.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,d){for(var g=0;16>g;g++){var h=d+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var g=this._hash.words,h=a[d+0],i=a[d+1],j=a[d+2],l=a[d+3],m=a[d+4],n=a[d+5],o=a[d+6],p=a[d+7],q=a[d+8],r=a[d+9],s=a[d+10],t=a[d+11],u=a[d+12],v=a[d+13],w=a[d+14],x=a[d+15],y=g[0],z=g[1],A=g[2],B=g[3],y=b(y,z,A,B,h,7,k[0]),B=b(B,y,z,A,i,12,k[1]),A=b(A,B,y,z,j,17,k[2]),z=b(z,A,B,y,l,22,k[3]),y=b(y,z,A,B,m,7,k[4]),B=b(B,y,z,A,n,12,k[5]),A=b(A,B,y,z,o,17,k[6]),z=b(z,A,B,y,p,22,k[7]),y=b(y,z,A,B,q,7,k[8]),B=b(B,y,z,A,r,12,k[9]),A=b(A,B,y,z,s,17,k[10]),z=b(z,A,B,y,t,22,k[11]),y=b(y,z,A,B,u,7,k[12]),B=b(B,y,z,A,v,12,k[13]),A=b(A,B,y,z,w,17,k[14]),z=b(z,A,B,y,x,22,k[15]),y=c(y,z,A,B,i,5,k[16]),B=c(B,y,z,A,o,9,k[17]),A=c(A,B,y,z,t,14,k[18]),z=c(z,A,B,y,h,20,k[19]),y=c(y,z,A,B,n,5,k[20]),B=c(B,y,z,A,s,9,k[21]),A=c(A,B,y,z,x,14,k[22]),z=c(z,A,B,y,m,20,k[23]),y=c(y,z,A,B,r,5,k[24]),B=c(B,y,z,A,w,9,k[25]),A=c(A,B,y,z,l,14,k[26]),z=c(z,A,B,y,q,20,k[27]),y=c(y,z,A,B,v,5,k[28]),B=c(B,y,z,A,j,9,k[29]),A=c(A,B,y,z,p,14,k[30]),z=c(z,A,B,y,u,20,k[31]),y=e(y,z,A,B,n,4,k[32]),B=e(B,y,z,A,q,11,k[33]),A=e(A,B,y,z,t,16,k[34]),z=e(z,A,B,y,w,23,k[35]),y=e(y,z,A,B,i,4,k[36]),B=e(B,y,z,A,m,11,k[37]),A=e(A,B,y,z,p,16,k[38]),z=e(z,A,B,y,s,23,k[39]),y=e(y,z,A,B,v,4,k[40]),B=e(B,y,z,A,h,11,k[41]),A=e(A,B,y,z,l,16,k[42]),z=e(z,A,B,y,o,23,k[43]),y=e(y,z,A,B,r,4,k[44]),B=e(B,y,z,A,u,11,k[45]),A=e(A,B,y,z,x,16,k[46]),z=e(z,A,B,y,j,23,k[47]),y=f(y,z,A,B,h,6,k[48]),B=f(B,y,z,A,p,10,k[49]),A=f(A,B,y,z,w,15,k[50]),z=f(z,A,B,y,n,21,k[51]),y=f(y,z,A,B,u,6,k[52]),B=f(B,y,z,A,l,10,k[53]),A=f(A,B,y,z,s,15,k[54]),z=f(z,A,B,y,i,21,k[55]),y=f(y,z,A,B,q,6,k[56]),B=f(B,y,z,A,x,10,k[57]),A=f(A,B,y,z,o,15,k[58]),z=f(z,A,B,y,v,21,k[59]),y=f(y,z,A,B,m,6,k[60]),B=f(B,y,z,A,t,10,k[61]),A=f(A,B,y,z,j,15,k[62]),z=f(z,A,B,y,r,21,k[63]);g[0]=g[0]+y|0,g[1]=g[1]+z|0,g[2]=g[2]+A|0,g[3]=g[3]+B|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/4294967296);for(c[(e+64>>>9<<4)+15]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[(e+64>>>9<<4)+14]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),b.sigBytes=4*(c.length+1),this._process(),b=this._hash,c=b.words,d=0;4>d;d++)e=c[d],c[d]=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8);return b},clone:function(){var a=j.clone.call(this);return a._hash=this._hash.clone(),a}}),g.MD5=j._createHelper(h),g.HmacMD5=j._createHmacHelper(h)}(Math),function(){var a=d,b=a.lib,c=b.Base,e=b.WordArray,b=a.algo,f=b.EvpKDF=c.extend({cfg:c.extend({keySize:4,hasher:b.MD5,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,d=c.hasher.create(),f=e.create(),g=f.words,h=c.keySize,c=c.iterations;g.length<h;){i&&d.update(i);var i=d.update(a).finalize(b);d.reset();for(var j=1;c>j;j++)i=d.finalize(i),d.reset();f.concat(i)}return f.sigBytes=4*h,f}});a.EvpKDF=function(a,b,c){return f.create(c).compute(a,b)}}();var e="We@53&es&esT*7%s";d.lib.Cipher||function(a){var b=d,c=b.lib,e=c.Base,f=c.WordArray,g=c.BufferedBlockAlgorithm,h=b.enc.Base64,i=b.algo.EvpKDF,j=c.Cipher=g.extend({cfg:e.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){g.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){return a&&this._append(a),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{encrypt:function(b,c,d){return("string"==typeof c?p:o).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?p:o).decrypt(a,b,c,d)}}}});c.StreamCipher=j.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var k=b.mode={},l=function(b,c,d){var e=this._iv;e?this._iv=a:e=this._prevBlock;for(var f=0;d>f;f++)b[c+f]^=e[f]},m=(c.BlockCipherMode=e.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}})).extend();m.Encryptor=m.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize;l.call(this,a,b,d),c.encryptBlock(a,b),this._prevBlock=a.slice(b,b+d)}}),m.Decryptor=m.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);c.decryptBlock(a,b),l.call(this,a,b,d),this._prevBlock=e}}),k=k.CBC=m,m=(b.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,e=[],g=0;c>g;g+=4)e.push(d);c=f.create(e,c),a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}},c.BlockCipher=j.extend({cfg:j.cfg.extend({mode:k,padding:m}),reset:function(){j.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var n=c.CipherParams=e.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),k=(b.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;return a=a.salt,(a?f.create([1398893684,1701076831]).concat(a).concat(b):b).toString(h)},parse:function(a){a=h.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=f.create(b.slice(2,4));b.splice(0,4),a.sigBytes-=16}return n.create({ciphertext:a,salt:c})}},o=c.SerializableCipher=e.extend({cfg:e.extend({format:k}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);return b=e.finalize(b),e=e.cfg,n.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),b=(b.kdf={}).OpenSSL={execute:function(a,b,c,d){return d||(d=f.random(8)),a=i.create({keySize:b+c}).compute(a,d),c=f.create(a.words.slice(b),4*c),a.sigBytes=4*b,n.create({key:a,iv:c,salt:d})}},p=c.PasswordBasedCipher=o.extend({cfg:o.cfg.extend({kdf:b}),encrypt:function(a,b,c,d){return d=this.cfg.extend(d),c=d.kdf.execute(c,a.keySize,a.ivSize),d.iv=c.iv,a=o.encrypt.call(this,a,b,c.key,d),a.mixIn(c),a},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt),d.iv=c.iv,o.decrypt.call(this,a,b,c.key,d)}})}(),function(){for(var a=d,b=a.lib.BlockCipher,c=a.algo,e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=0;256>p;p++)o[p]=128>p?p<<1:p<<1^283;for(var q=0,r=0,p=0;256>p;p++){var s=r^r<<1^r<<2^r<<3^r<<4,s=s>>>8^255&s^99;e[q]=s,f[s]=q;var t=o[q],u=o[t],v=o[u],w=257*o[s]^16843008*s;g[q]=w<<24|w>>>8,h[q]=w<<16|w>>>16,i[q]=w<<8|w>>>24,j[q]=w,w=16843009*v^65537*u^257*t^16843008*q,k[s]=w<<24|w>>>8,l[s]=w<<16|w>>>16,m[s]=w<<8|w>>>24,n[s]=w,q?(q=t^o[o[o[v^t]]],r^=o[o[r]]):q=r=1}var x=[0,1,2,4,8,16,32,64,128,27,54],c=c.AES=b.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes/4,a=4*((this._nRounds=c+6)+1),d=this._keySchedule=[],f=0;a>f;f++)if(c>f)d[f]=b[f];else{var g=d[f-1];f%c?c>6&&4==f%c&&(g=e[g>>>24]<<24|e[g>>>16&255]<<16|e[g>>>8&255]<<8|e[255&g]):(g=g<<8|g>>>24,g=e[g>>>24]<<24|e[g>>>16&255]<<16|e[g>>>8&255]<<8|e[255&g],g^=x[f/c|0]<<24),d[f]=d[f-c]^g}for(b=this._invKeySchedule=[],c=0;a>c;c++)f=a-c,g=c%4?d[f]:d[f-4],b[c]=4>c||4>=f?g:k[e[g>>>24]]^l[e[g>>>16&255]]^m[e[g>>>8&255]]^n[e[255&g]]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,g,h,i,j,e)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this._doCryptBlock(a,b,this._invKeySchedule,k,l,m,n,f),c=a[b+1],a[b+1]=a[b+3],a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,g,h){for(var i=this._nRounds,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;i>o;o++)var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],m=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++],j=p,k=q,l=r;p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],m=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++],a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=m},keySize:8});a.AES=b._createHelper(c)}(),d.pad.Iso10126={pad:function(a,b){var c=4*b,c=c-a.sigBytes%c;a.concat(d.lib.WordArray.random(c-1)).concat(d.lib.WordArray.create([c<<24],1))},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}},b.md5=function(a){return d.MD5(a).toString().toUpperCase()},b.encrypt=function(a,b){var e=d.enc.Utf8.parse(c(b)),f=d.AES.encrypt(d.enc.Utf8.parse(a),e,{iv:e,mode:d.mode.CBC,padding:d.pad.Iso10126});return d.enc.Base64.stringify(f.ciphertext)},b.decrypt=function(a,b){var e=d.enc.Utf8.parse(c(b)),f=d.AES.decrypt(a,e,{iv:e,mode:d.mode.CBC,padding:d.pad.Iso10126});return f.toString(d.enc.Utf8)}}),define("lib/core/base64",[],function(a,b){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";b.encode=function(a){if(a=unescape(encodeURIComponent(a)),""!==a){var b,d,e,f,g,h,i,j,k=0,l=0,m="",n=[];if(!a)return a;do b=a.charCodeAt(k++),d=a.charCodeAt(k++),e=a.charCodeAt(k++),j=b<<16|d<<8|e,f=j>>18&63,g=j>>12&63,h=j>>6&63,i=63&j,n[l++]=c.charAt(f)+c.charAt(g)+c.charAt(h)+c.charAt(i);while(k<a.length);m=n.join("");var o=a.length%3;return(o?m.slice(0,o-3):m)+"===".slice(o||3)}},b.decode=function(a){var b,d,e,f,g,h,i,j,k=0,l=0,m="",n=[];if(!a)return a;a+="";do f=c.indexOf(a.charAt(k++)),g=c.indexOf(a.charAt(k++)),h=c.indexOf(a.charAt(k++)),i=c.indexOf(a.charAt(k++)),j=f<<18|g<<12|h<<6|i,b=j>>16&255,d=j>>8&255,e=255&j,n[l++]=64==h?String.fromCharCode(b):64==i?String.fromCharCode(b,d):String.fromCharCode(b,d,e);while(k<a.length);return m=n.join(""),decodeURIComponent(escape(m))}}),define("lib/core/console",[],function(a,b,c){if(window.console)return window.console.debug||(window.console.debug=window.console.info),window.console;for(var d,e,f={},g=["memory"],h=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];d=g.pop();)f[d]={};for(;e=h.pop();)f[e]=function(){};c.exports=f}),define("lib/core/date",[],function(a,b){b.DEFAULT_DATE_FORMAT="yyyyMMdd",b.DEFAULT_TIME_FORMAT="hh:mm:ss",b.DEFAULT_DATE_TIME_FORMAT="yyyyMMdd hh:mm:ss",b.newDate=function(){return new Date},b.parse=function(a){if(_.isDate(a))return a;if(_.isString(a)){var b;if(b=a.match(/^(\d{4})(\D)?(\d{1,2})(\D)?(\d{1,2})( )?((\d{2})(:)?(\d{2})(:)?(\d{2}))?$/))return new Date(b[1],parseInt(b[3])-1,b[5],b[8]||null,b[10]||null,b[12]||null)}},b.format=function(a,c){var d=b.parse(a),c=c||b.DEFAULT_DATE_TIME_FORMAT;return _.isDate(d)?(_.each({"y+":d.getFullYear()+"","M+":d.getMonth()+1+"","d+":d.getDate()+"","h+":d.getHours()+"","m+":d.getMinutes()+"","s+":d.getSeconds()+"","q+":Math.floor((d.getMonth()+3)/3)+"",S:d.getMilliseconds()+""},function(a,b){if(new RegExp("("+b+")").test(c)){for(var d=RegExp.$1.length,e=a.length,f=0,g=d-(e%d||d);g>f;f++)a="0"+a;c=c.replace(RegExp.$1,a)}}),c):a},b.formatDate=function(a){return b.format(a,b.DEFAULT_DATE_FORMAT)},b.formatTime=function(a){return b.format(a,b.DEFAULT_TIME_FORMAT)},b.getClientDate=function(){return b.format(new Date,b.DEFAULT_DATE_FORMAT)},b.getClientTime=function(){return b.format(new Date,b.DEFAULT_TIME_FORMAT)},b.getClientDateTime=function(){return b.format(new Date,b.DEFAULT_DATE_TIME_FORMAT)},b.isLeapYear=function(a){return isNaN(a)?!1:0===a%4&&0!==a%100||0===a%100&&0===a%400},b.getMonthDays=function(a,b){return[void 0,31,this.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},b.getDayOfWeek=function(a){return b.parse(a).getDay()},b.compareDate=function(a,c){var d=b.parse(a).getTime(),e=b.parse(c).getTime(),f=d-e;return f>0?1:0>f?-1:0
},b.getDifferMonths=function(a,c){var d,e,f,g,h,i,j,k,l=b.parse(a),m=b.parse(c),n=l.getTime(),o=m.getTime();return n===o?0:n>o?-1:(d=l.getFullYear(),e=l.getMonth()+1,f=l.getDate(),g=m.getFullYear(),h=m.getMonth()+1,i=m.getDate(),j=this.getMonthDays(d,e),k=this.getMonthDays(g,h),g>d?12*(g-d-1)+(h+(i>=f||i===k&&j>=f?12-e:12-e-1)):h===e?0:h-e-(i>=f||i===k&&j>=f?0:1))},b.getDifferYears=function(a,c){var d=b.getDifferMonths(a,c);return d>=0?parseInt(d/12):-1},b.getDifferDays=function(a,c){var a=b.parse(a).getTime(),c=b.parse(c).getTime(),d=c-a;return d>=0?parseInt(d/864e5):0}}),define("lib/core/number",[],function(a,b){b.convertMoney=function(a,b){b=_.isUndefined(b)?!0:!!b;var c,d=$.trim(a+"").replace(/,/g,""),e=Number(d),f="零壹贰叁肆伍陆柒捌玖",g="万仟佰拾亿仟佰拾万仟佰拾圓角分",h="";if(isNaN(e))return"";if(e>9999999999999.99||-9999999999999.99>e)return"";0>e&&(d=d.substring(1,d.length)),d+="00",(c=d.indexOf("."))>=0&&(d=d.substring(0,c)+d.substr(c+1,2));for(var i=0,j=d.length;j>i;i++)h+=f.charAt(d.charAt(i))+g.substr(g.length-d.length).charAt(i);return h="零圓零角零分"===h?"零圓":h.replace(/零(仟|佰|拾|角)/g,"零").replace(/(零)+/g,"零").replace(/零(万|亿|圓)/g,"$1").replace(/(亿)万/g,"$1").replace(/^圓零?|零分/g,"").replace(/圓$/g,"圓整"),b||(h=-1!==h.indexOf("角")||-1!==h.indexOf("分")?h.replace(/(角|分)/g,"").replace(/(圓|圓整)/g,"点"):h.replace(/(圓整|圓)/g,"")),h&&0>e?"负"+h:h},b.formatNumber=function(a){if(!/^(\+|-)?(\d+)(,\d{3})*(\.|\.\d+)?$/.test(a))return a;for(var b=/(\d)(\d{3})(,|$)/,c=RegExp.$1,d=RegExp.$2,e=RegExp.$4;b.test(d);)d=d.replace(b,"$1,$2$3");return c+""+d+e},b.toFixed=function(a,b){b=_.isUndefined(b)?0:Number(b);var c=$.trim(a+"").replace(/,/g,""),d=Number(c);return isNaN(d)?a:isNaN(b)||0>b?a:d.toFixed(b)},b.toExponential=function(a,b){b=_.isUndefined(b)?0:Number(b);var c=$.trim(a+"").replace(/,/g,""),d=Number(c);return isNaN(d)?a:isNaN(b)||0>b?a:d.toExponential(b)}}),define("lib/core/parser",["lib/core/ajax","lib/core/cache","lib/core/sm4","lib/core/uri","lib/core/utils","lib/core/aes","lib/core/view"],function(require,exports,module){var ajax=require("lib/core/ajax"),view=require("lib/core/view");exports.loadCss=function(a,b){var c=$.Deferred();return $("head").append($("<link rel='stylesheet'>").attr("href",a).load(function(){c.resolveWith(this,arguments)}).error(function(){0!=b?c.resolveWith(this,arguments):c.rejectWith(this,arguments)})),c.promise()},!function(){var a={};exports.getContextObj=function(){return a},exports.setContextObj=function(b){b&&$.extend(a,b)}}(),exports.handleObject=function(obj,contextObj){function valueEval(v,ctxObj){var rExp=/^\{([\S\s]+)\}/,matched;if("true"===v)return!0;if("false"===v)return!1;if((matched=v.match(rExp))&&matched[1])try{with(ctxObj||{}){var retEval=eval(matched[1]);return null==retEval?v:retEval}}catch(e){}if(!isNaN(v))return v;try{return utils.parse(v)}catch(e){}return v}function contextEval(objName,str){try{return eval(objName+"."+str)}catch(e){}}var ctxObj=$.extend(!0,{},exports.getContextObj(),contextObj),tmp;for(var key in obj)("data"!==key||_.isString(obj[key]))&&("req"!==key&&"data"!==key&&"conf"!==key||!_.isString(obj[key])?$.isPlainObject(obj[key])||$.isArray(obj[key])?arguments.callee.call(this,obj[key],ctxObj):(_.isString(obj[key])&&(obj[key]=valueEval(obj[key],ctxObj)),ctxObj&&_.isString(obj[key])&&(obj[key]=obj[key].indexOf(".")>=0&&(tmp=contextEval("ctxObj",obj[key]))?tmp:ctxObj[obj[key]]||obj[key])):obj[key]=eval("("+obj[key]+")"));return obj},exports.parseOptions=function(a,b){var c=$(a),d={},e=$.trim(c.attr("kui-options"));if(e){var f=e.substring(0,1);"{"!==f&&(e="{"+e+"}"),d=new Function("return "+e)()}if(b){for(var g={},h=0;h<b.length;h++){var i=b[h];if("string"==typeof i)g[i]="width"===i||"height"===i||"left"===i||"top"===i?parseInt(a.style[i])||void 0:c.attr(i);else for(var j in i){var k=i[j];"boolean"===k?g[j]=c.attr(j)?"true"===c.attr(j):void 0:"number"===k&&(g[j]="0"===c.attr(j)?0:parseFloat(c.attr(j))||void 0)}}$.extend(d,g)}return this.handleObject(d,this.getContextObj()||{}),d},exports.getViewConfig=function(a){return view.getViewConfig(a).then(function(a){return exports.handleObject(a.getConfigObj()),a})},exports.parseContext=function(a){function b(a){return-1!==$.inArray(a,["datagrid","reportgrid","form","treegrid","sform"])}function c(a){var b,c;if(c=$(a).attr("class"))return $.each(c.split(" "),function(){return this&&this.startsWith("kui-")?(b=this.replace("kui-",""),!1):void 0}),b}var d,e,a=$(a),f=[],g=[];return $("[class*='kui-']",a).add(a).each(function(){return d={},d.target=$(this),d.name=d.target.attr("name"),d.provider=c(this),d.provider&&$.fn[d.provider]?d.target.data(d.provider)?!0:(b(d.provider)&&!1!==d.target.data("remote")&&(e=d.target.data("view")||d.target.attr("id"))&&(d.viewId=e,-1===$.inArray(e,f)&&f.push(e)),void g.push(d)):!0}),{context:a,viewIds:f.join(","),elems:g,uioptions:a.data("uioptions")||{}}},exports.director=exports.parse=function(a,b){if(!a||!$(a).length)return $.when(void 0);var c=exports.parseContext(a);return c.elems&&c.elems.length?exports.getViewConfig(c.viewIds).then(function(a){b&&exports.setContextObj(b),a.isEmpty()||exports.handleObject(a.getConfigObj(),exports.getContextObj()),$.each(c.elems||[],function(){var b=this.name,d=this.viewId,e=this.provider;this.target[e](d?a[d]||{}:b?c.uioptions[b]||{}:{})})}):$.when(void 0)},exports.createCommonDialog=function(a,b){function c(a){return!!(_.isObject(a)&&a.jquery&&a.length&&_.isElement(a[0])&&a.data("datagrid"))}var d=$("<div></div>"),e=$("<form></form>").appendTo(d),f=!!a.modify,g=b||{};if(f&&c(a.$datagrid)&&!(g=a.$datagrid.datagrid("getSelected")))return void alert("请选择表格中的一行数据！",alert.ERROR);if(!_.isFunction(a.onBeforeOpen)||!1!==a.onBeforeOpen.call(d))return d.dialog({title:a.title||"通用对话框",modal:!0,width:a.width||570,height:a.height||300,buttons:[{text:"保存",iconCls:"icon-save",handler:function(){function b(){c=loading("操作中,请稍候..."),ajax.post({req:$.extend({},a.req,h)}).done(function(){alert(a.successMsg||"操作成功！"),d.dialog("close"),_.isFunction(a.onSaveSuccess)&&a.onSaveSuccess.call(e,h)}).always(function(){c.destroy()})}if(e.form("validate")){var c,h=e.form("getData");return f&&_.isMatch(g,h)?(alert("数据未发生修改，请修改数据后重试！"),!1):void(_.isFunction(a.onBeforeSave)&&!1===a.onBeforeSave.call(e,h,d)||(a.isConfirm?confirm("提示",a.confirmMsg||"是否保存数据？",function(a){a&&b()}):b()))}}},{text:"关闭",iconCls:"icon-cancel",handler:function(){d.dialog("close")}}],onClose:function(){d.dialog("destroy")}}),e.form({loadingMask:!0,modify:f,colNumbers:a.colNumbers||2,col:c(a.$datagrid)&&a.$datagrid.datagrid("getOriginalColumns")||a.col,record:a.record,onInitSuccess:function(){_.isFunction(a.onBeforeLoad)&&!1===a.onBeforeLoad.call(e,g)||(e.form("load",g),_.isFunction(a.onFormInitSuccess)&&a.onFormInitSuccess.call(e,g))}}),{$dialog:d,$form:e}}}),define("lib/core/view",[],function(a,b){function c(a){$.extend(this,a)}function d(a){function b(a){_.each(a,function(a){var b=a.type&&"input"!=a.type&&a.type||"text",c=a.editor||{};if(c.dict)d(c.dict,c);else if(("combobox"==b||"combotree"==b)&&c.req&&1!=c.sync){$.extend(c,parser.handleObject({req:c.req}));var f=_.isArray(c.req)?c.req[0]:c.req;c.req=[],e(f,c)}a.editor={options:c,type:b}})}function c(a){a.service&&!a.req&&(a.req=[{service:a.service}],delete a.service)}function d(a,b){f[a]?f[a].push(b):f[a]=[b]}function e(a,b){g.push({req:a,data:b})}var f={},g=[],h=$.Deferred();for(var i in a){var j=a[i],k=j.render;if(c(j),_.contains(["datagrid","treegrid","reportgrid"],k))b((j.queryCols||[]).concat(j.columns||[])),$.extend(j,{queryCols:j.queryCols?[{cols:j.queryCols}]:[],columns:j.columns?[j.columns]:[]});else if(_.contains(["form","sform"],k)){var l=j.queryCols&&j.queryCols.length>0?j.queryCols:j.columns&&j.columns.length>0?j.columns:[];b(l),$.extend(j,{queryCols:[{cols:l}]})}j.toolbar&&_.each(j.toolbar,function(a){c(a)})}if(!_.isEmpty(f)){var m=_.keys(f).join(","),n=dict.getDictDataObj(m)||{};_.each(f,function(a,b){var c=n[b]||[];_.each(a,function(a){a.data=c})})}return g.length>0?ajax.post(_.pluck(g,"req")).then(function(a,b){_.each(g,function(a,c){a.data.data=b.get(c).getData()[0],a.data.req=[a.req]})}).always(function(){h.resolve()}):h.resolve(),h.promise()}c.extend({size:function(){return _.keys(this.getConfigObj()).length},isEmpty:function(){return _.isEmpty(this.getConfigObj())},get:function(a){return this[a]},getConfigObj:function(){var a={};for(var b in this)this.hasOwnProperty(b)&&(a[b]=this[b]);return a},getScript:function(){for(var a in this)if(this[a]["data-main"])return this[a]["data-main"]},getCss:function(){for(var a in this)if(this[a]["data-css"])return this[a]["data-css"]}}),b.ViewConfig=c,b.getViewConfig=function(){var a={};return function(b){var e=b?_.isArray(b)?b:b.split(","):[],f={};return _.each(e,function(b,c){a[b]&&(f[b]=a[b],e=e.splice(0,c))}),e.length?ajax.post({service:"P0000004",VIEW_IDS:e.join(",")}).then(function(b){var e=_.pick(b.getDataRow()||{},function(a){return!_.isEmpty(a)});return _.isEmpty(e)?new c(f):d(e).then(function(){return $.extend(a,e),$.extend(e,f),new c(e)})}):$.when(new c(f))}}()}),define("lib/core/pushlet",["lib/core/utils","lib/core/aes","lib/core/sm4"],function(a,b){function c(a,b){$.extend(this,a),this[d.expando]={data:a,head:b}}var d=a("lib/core/utils"),e=function(){this.pushletURL=null,this.webRoot=null,this.sessionId=null,this.state=1,this.lbm_req="",this.threadNum=1,this.statusMsg="null",this.statusChanged=!1,this.statusChanged="|",this.timestamp=0,this.debugWindow=null,this.messages=[],this.messagesIndex=0,this.debugOn=!1,this.events={}};e.NV_P_FORMAT="p_format=xml-strict",e.NV_P_MODE="p_mode=pull",e.STATE_ERROR=-2,e.STATE_ABORT=-1,e.STATE_NULL=1,e.STATE_READY=2,e.STATE_JOINED=3,e.STATE_LISTENING=3,e.prototype.heartbeat=function(){this._doRequest("hb")},e.prototype.join=function(){this.sessionId=null,this._doRequest("join",e.NV_P_FORMAT+"&"+e.NV_P_MODE)},e.prototype.joinListen=function(a){this._setStatus("join-listen "+a),this.sessionId=null;var b=e.NV_P_FORMAT+"&"+e.NV_P_MODE;a&&(b=b+"&p_subject="+a),this._doRequest("join-listen",b)},e.prototype.leave=function(){this._doRequest("leave")},e.prototype.listen=function(a){var b=e.NV_P_MODE;a&&(b=b+"&p_subject="+a),this._doRequest("listen",b)},e.prototype.publish=function(a,b){var c="p_subject="+a;b&&(c=c+"&"+b),this._doRequest("publish",c)},e.prototype.subscribe=function(a,b){var c="p_subject="+a;b&&(c=c+"&p_label="+b),this._doRequest("subscribe",c)},e.prototype.unsubscribe=function(a){var b;a&&(b="p_sid="+a),this._doRequest("unsubscribe",b)},e.prototype.setDebug=function(a){this.debugOn=a},e.prototype._addEvent=function(a,b,c,d){var e=this._getObject(a);if(e.addEventListener)return e.addEventListener(b,c,d),!0;if(e.attachEvent){var f=e.attachEvent("on"+b,c);return f}e["on"+b]=c},e.prototype._doCallback=function(a,b){b?b(a):this.events.onEvent&&this.events.onEvent(a)},e.prototype._doRequest=function(a,b){var c=this;if(this.state<0)return void this._setStatus("died ("+this.state+")");var d=!1;if("join"==a||"join-listen"==a)d=this.state<e.STATE_READY;else if("leave"==a)this.state=e.STATE_READY;else if("refresh"==a){if(this.state!=e.STATE_LISTENING)return}else d="listen"==a?this.state<e.STATE_JOINED:"subscribe"==a||"unsubscribe"==a?this.state<e.STATE_LISTENING:this.state<e.STATE_JOINED;if(1==d)return this._setStatus(a+" , waiting... state="+this.state),void setTimeout(function(){c._doRequest(a,b)},100);var f=this.pushletURL+"?p_event="+a;b&&(f=f+"&"+b),null!=this.sessionId&&(f=f+"&p_id="+this.sessionId,"p_leave"==a&&(this.sessionId=null)),this.debug("_doRequest",f),this._getResponseXML(f,this._onResponse)},e.prototype._getObject=function(a){return"string"==typeof a?document.getElementById(a):a},e.prototype._getWebRoot=function(){if(null!=this.webRoot)return this.webRoot;for(var a=document.getElementsByTagName("head")[0],b=a.childNodes,c=0;c<b.length;++c){var d=b.item(c).src;if(d){var e=d.indexOf("ajax-pushlet-client.js");if(e>=0){e=d.indexOf("frame/js"),this.webRoot=d.substring(0,e);break}}}return this.webRoot},e.prototype._getXML=function(a,b){var c=this,d=new XMLHttpRequest;if(!d||null==d)return void alert("No browser XMLHttpRequest (AJAX) support");var e=b,g=!1;if(e&&(g=!0,d.onreadystatechange=function(){if(4==d.readyState)if(200==d.status)e(d.responseXML),d=null;else{var a=new f;a.put("p_event","error"),a.put("p_reason","[pushlet] problem retrieving XML data:\n"+d.statusText),c._onEvent(a)}}),d.open("get",a,g),d.send(null),!e){if(200!=d.status){var h=new f;return h.put("p_event","error"),h.put("p_reason","[pushlet] problem retrieving XML data:\n"+d.statusText),c._onEvent(h),null}return d.responseXML}},e.prototype._getResponseXML=function(a,b){var c=this,d=b;$.ajax({url:a.split("?")[0],data:c.getJsonFromStr(a.split("?")[1]),type:"post",success:function(a){return d?void d.call(c,a):a},error:function(a){var b=new f;b.put("p_event","error"),b.put("p_reason","[pushlet] problem retrieving XML data:\n"+a.statusText),c._onEvent(b)}})},e.prototype.getJsonFromStr=function(a){for(var b={},c=a.split("&"),d=0;d<c.length;d++){var e=c[d];b[e.split("=")[0]]=e.split("=")[1]}return b},e.prototype._init=function(){this._setStatus("initializing..."),window.ActiveXObject&&!window.XMLHttpRequest&&(window.XMLHttpRequest=function(){for(var a=new Array("Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"),b=0;b<a.length;b++)try{return new ActiveXObject(a[b])}catch(c){}return null}),!window.ActiveXObject&&window.XMLHttpRequest&&(window.ActiveXObject=function(a){switch(a.toLowerCase()){case"microsoft.xmlhttp":case"msxml2.xmlhttp":case"msxml2.xmlhttp.3.0":case"msxml2.xmlhttp.4.0":case"msxml2.xmlhttp.5.0":return new XMLHttpRequest}return null}),this.pushletURL=uri.resolve("pushlet.srv#"),this._setStatus("initialized"),this.state=e.STATE_READY},e.prototype._onEvent=function(a){var b=this;this.debug("_onEvent()",a.toString());var c=a.getEvent();if("data"==c)this._setStatus("data"),this._doCallback(a,this.events.onData);else{if("refresh"==c){this.state<e.STATE_LISTENING&&this._setStatus("not refreshing state="+e.STATE_LISTENING);var d=a.get("p_wait");return void setTimeout(function(){b._doRequest("refresh")},d)}"error"==c?(this.state=e.STATE_ERROR,this._setStatus("server error: "+a.get("p_reason")),this._doCallback(a,this.events.onError)):"join-ack"==c?(this.state=e.STATE_JOINED,this.sessionId=a.get("p_id"),this._setStatus("connected"),this._doCallback(a,this.events.onJoinAck)):"join-listen-ack"==c?(this.state=e.STATE_LISTENING,this.sessionId=a.get("p_id"),this._setStatus("join-listen-ack"),this._doCallback(a,this.events.onJoinListenAck)):"listen-ack"==c?(this.state=e.STATE_LISTENING,this._setStatus("listening"),this._doCallback(a,this.events.onListenAck)):"hb"==c?(this._setStatus("heartbeat"),this._doCallback(a,this.events.onHeartbeat)):"hb-ack"==c?this._doCallback(a,this.events.onHeartbeatAck):"leave-ack"==c?(this._setStatus("disconnected"),this._doCallback(a,this.events.onLeaveAck)):"refresh-ack"==c?this._doCallback(a,this.events.onRefreshAck):"subscribe-ack"==c?(this._setStatus("subscribed to "+a.get("p_subject")),this._doCallback(a,this.events.onSubscribeAck)):"unsubscribe-ack"==c?(this._setStatus("unsubscribed"),this._doCallback(a,this.events.onUnsubscribeAck)):"abort"==c?(this.state=e.STATE_ERROR,this._setStatus("abort"),this._doCallback(a,this.events.onAbort)):c.match(/nack$/)&&(this._setStatus("error response: "+a.get("p_reason")),this._doCallback(a,this.events.onNack))}},e.prototype._onResponse=function(a){this.debug("_onResponse",a);var b=this._rsp2Events(a);if(null==b)return void this._setStatus("null events");delete a,this.debug("_onResponse eventCnt=",b.length);for(var c=0;c<b.length;c++)this._onEvent(b[c])},e.prototype._rsp2Events=function(a){if(!a||!a.documentElement)return null;var b=a.documentElement.getElementsByTagName("event"),c=new Array(b.length);for(i=0;i<b.length;i++)c[i]=new f(b[i]);return c},e.prototype._showStatus=function(){1==this.statusChanged&&(this.statusChar="|"==this.statusChar?"/":"/"==this.statusChar?"--":"--"==this.statusChar?"\\":"|",this.statusChanged=!1),window.defaultStatus=this.statusMsg,window.status=this.statusMsg+"  "+this.statusChar,timeout=window.setTimeout("this._showStatus()",400)},e.prototype._setStatus=function(a){this.statusMsg="pushlet - "+a,this.statusChanged=!0},e.prototype.debug=function(a,b){if(0!=this.debugOn){var c="none";this.debug.caller&&(c=this.debug.caller.toString(),c=c.substring(9,c.indexOf(")")+1));var d="-"+c+": "+a+"="+b,e=new Date,f=e-this.timestamp;1e4>f&&(d+=" ("+f+" msec)"),this.timestamp=e,(null==this.debugWindow||this.debugWindow.closed)&&(this.debugWindow=window.open("","p_debugWin","toolbar=no,scrollbars=yes,resizable=yes,width=600,height=400")),this.messages[this.messagesIndex++]=d,this.debugWindow.document.writeln("<html><head><title>Pushlet Debug Window</title></head><body bgcolor=#DDDDDD>");for(var g=0;g<this.messagesIndex;g++)this.debugWindow.document.writeln("<pre>"+g+": "+this.messages[g]+"</pre>");this.debugWindow.document.writeln("</body></html>"),this.debugWindow.document.close(),this.debugWindow.focus(),this.debugWindow.scrollTo(this.debugWindow.scrollX,1e5)}},e.prototype.on=function(a,b){if(a&&_.isString(a)&&_.isFunction(b)){var c=a.replace(/\S/,function(a){return a.toUpperCase()});this.events["on"+c]=b}};var f=function(a){if(this.arr=new Array,this.getSubject=function(){return this.get("p_subject")},this.getEvent=function(){return this.get("p_event")},this.put=function(a,b){return this.arr[a]=b},this.get=function(a){return this.arr[a]},this.toString=function(){var a="";for(var b in this.arr)a=a+b+"="+this.arr[b]+"\n";return a},this.toTable=function(){var a='<table border="1" cellpadding="3">',b='<div style="color:black; font-family:monospace; font-size:10pt; white-space:pre;">';for(var c in this.arr)a=a+"<tr><td bgColor=white>"+b+c+"</div></td><td bgColor=white>"+b+this.arr[c]+"</div></td></tr>";return a+="</table>"},a)for(var b=0;b<a.attributes.length;b++)this.put(a.attributes[b].name,a.attributes[b].value)};c.extend({getData:function(){return this[d.expando].data},isSuccess:function(){return-1!==_.indexOf(["0","100","9010001","-130011","-404","106192"],this.getMsgCode())},getClientId:function(){return this[d.expando].head.clientId},getMsgCode:function(){return this[d.expando].head.errorCode},getMsgText:function(){return this[d.expando].head.errorMsg},getRunTimes:function(){return this[d.expando].head.runTimes||"0"},getRowId:function(){return this[d.expando].head.rowId}}),b.request=function(a,b){var f=new e,g=a.req||a.lbm_req||a;g=_.isArray(g)?g:[g];var h=a.req||a.lbm_req?_.omit(a,"req","lbm_req"):b||{};return f.threadNum=h.threadNum||1,f.type="multiple"==h.type||h.multiple?"multiple":void 0,f.lbm_req=d.AESEncrypt(JSON.stringify({lbm_req:_.chain(g).map(function(a){return a["@TYPE"]=!1!==h.common?"common":void 0,a}).value()})),f._init(),f.joinListen("/plPush"),f.on("joinListenAck",function(){$.ajax({url:uri.resolve("plLbmAction#"),data:{lbm_req:f.lbm_req,threadNum:f.threadNum,clientId:f.sessionId,type:f.type},type:"post",async:!0})}),f.on("data",function(a){var b,e=JSON.parse(a.get("val")),f=_.omit(e,"data");try{b=_.isString(e.data)&&e.data?JSON.parse(d.unescape(e.data).replace(/}{/g,"},{")):e.data}catch(g){var i=d.unescape(e.data).match(/ error code:.*/g)?d.unescape(e.data).match(/ error code:.*/g)[0].replace(/:/g," ").replace(/,/g," ").replace("],",'",').replace(/\"/g," ").replace("}]",'"}]'):"json解析错误";b=JSON.parse(d.unescape(e.data).replace(/}{/g,"},{").replace(/ error code:.*/g,i))}_.isFunction(h.callback)&&h.callback.call(a,new c(b||[],f))}),{leave:function(){f.leave()}}},b.plRequest=function(a){return b.request($.extend({},a,{common:!1}))},b.post=function(a,c){var d=$.Deferred(),e=a.req||a,f=$.extend({showErrorPrompt:!0,noProcess:!1},a.req?_.omit(a,"req"):c||{}),g=b.request(e,$.extend({},f,{callback:function(a){return g.leave(),f.noProcess?void d.resolveWith(this,[a]):void(a.isSuccess()?d.resolveWith(this,[a]):(f.showErrorPrompt&&top.alert(head.errorMsg||"业务执行失败！",alert.ERROR),d.rejectWith(this,[a])))}}));return d.promise()}}),define("lib/core/param",["lib/core/ajax","lib/core/cache","lib/core/sm4","lib/core/uri","lib/core/utils","lib/core/aes"],function(a,b,c){function d(a){$.extend(this,a)}function e(a){for(var b in a)this[b]=new d(a[b]||{})}function f(a){var b=cache.getData(c)||{},d=[],f=!a||_.isArray(a)?a:a.split(",");return a?(_.each(f,function(a){_.isEmpty(b[a])&&d.push(a)}),d.length?(l.post({service:"P0000005",CACHE_TYPE:"sysParamCache",KEY_CODES:d.join(",")},{async:!1}).then(function(a){var d=a.getDataRow();d&&!$.isEmptyObject(d)&&_.each(d,function(a,c){d[c]?b[c]=_.isArray(a)&&a.length>0?a[0]:a||{}:(console.warn("公共参数["+c+"]在缓存中不存在，请检查核对。"),b[c]={})}),cache.setData(c,b)}),new e(_.pick(b,f))):new e(_.pick(b,f))):new e({})}function g(){return l.post({service:"P0000061",CACHE_TYPE:"sysParamCache"})}function h(a){var b=i(a),c=_.isArray(a)?a:a.split(",");return c.length>1?b:1==c.length?b[c[0]]:0==c.length?"":void 0}function i(a){var b=f(a),c={};return _.each(b,function(a,d){c[d]=b.get(d).getValue()}),c}function j(a){return f(a)}function k(a){var b=j(a),c=_.isArray(a)?a:a.split(",");return c.length>1?b:1==c.length?b.get(null):null}var l=a("lib/core/ajax");return d.extend({getValue:function(){return this.PAR_VAL},getName:function(){return this.PAR_NAME},getData:function(){return this},isEmpty:function(){return!_.keys(this).length}}),e.extend({defaultParam:new d({}),get:function(a){return a&&this[a]||this.getFirstVal(this)||this.defaultParam},getFirstVal:function(a){for(var b in a)return a[b]},size:function(){return _.keys(this).length}}),{getSysParam:h,getSysParamObj:i,getSysParamInfo:k,getSysParamInfoObj:j,refreshCache:g}}),define("lib/core/dict",["lib/core/ajax","lib/core/cache","lib/core/sm4","lib/core/uri","lib/core/utils","lib/core/aes"],function(a,b,c){function d(a){$.extend(this,a)}function e(a){for(var b in a)this[b]=new d(a[b])}function f(a,b){var d=cache.getData(c)||{},e={},f=[];return _.each(a,function(a){var c=d[a];c?e[a]=b?_.filter(c,function(a){return a.ORG_CODE==b}):c:f.push(a)}),{cacheData:e,reqKeys:f}}function g(a){return!_.find(a,function(a){return a.DICT_ITEM.length>1})}function h(a,b){var d=_.filter(_.isString(a)?a.split(","):a,function(a){return!!a});if(!d||!_.isArray(d)||!d.length)return new e({});var g=f(d,b),h=g.cacheData,i=g.reqKeys;return i.length?(n.post({service:"P0000005",CACHE_TYPE:"dictCache",KEY_CODES:i.join(",")},{async:!1}).then(function(a){var d=a.getDataRow();if(d&&!$.isEmptyObject(d)){_.each(d,function(a){_.each(a,function(a){a.dict_des=a.DICT_ITEM_NAME,a.dict_val=a.DICT_ITEM})});var e={};cache.setData(c,$.extend({},cache.getData(c)||{},d)),b&&_.each(d,function(a,c){e[c]=_.filter(a,function(a){return a.ORG_CODE==b})}),$.extend(h,b?e:d)}}).fail(function(){console.warn("远程拉取字典数据失败！")}),new e(h)):new e(h)}function i(a,b,c){if(!a||!_.isString(a))throw"字典名传参不合规！";if(!b||!_.isString(b))throw"字典值传参不合规！";var d=h(a,c).get(a),e=b.split(_.indexOf(b,",")<0&&g(d)?"":","),f=[];return _.each(e,function(a){var b=d.getTextByVal(a);f.push(b||a)}),f.join("，")}function j(a,b,c,d){var e,f,g=_.isArray(a);if(!g&&!_.isObject(a))throw"数据传参不合规！";if(g&&!a.length)return a;if(_.isObject(a)&&$.isEmptyObject(a))return[a];e=$.extend(!d,[],g?a:[a]),f=function(){var a={};return _.each(_.isArray(b)?b:_.isString(b)?b.split(","):[b],function(b){_.isObject(b)?_.extend(a,b):_.isString(b)&&(a[b]=b)}),a}();var i=h(_.chain(f).values().unique().value(),c);return _.each(e,function(a){_.each(f,function(b,d){var e=i.get(b);e&&a[d]&&!a[d+"_TEXT"]&&(a[d+"_TEXT"]=e.getTextByVal(a[d],c))})}),g?e:e[0]}function k(){return n.post({service:"P0000061",CACHE_TYPE:"dictCache"})}function l(a,b){var c=_.filter(_.isString(a)?a.split(","):a,function(a){return!!a}),d=h(a,b);if(c.length>1){var e={};return _.each(d,function(a,b){e[b]=d.get(b).getData()}),e}return 1==c.length?d.get().getData():0==c.length?null:void 0}function m(a,b){var c=h(a,b),d={};return _.each(c,function(a,b){d[b]=c.get(b).getData()}),d}var n=a("lib/core/ajax");return d.extend({get:function(a){return _.isNumber(a)?this[a]:_.find(this,function(b){return b.DICT_ITEM==a})},getTextByVal:function(a,b){var c=_.chain(this.getData(b)).find(function(b){return b.DICT_ITEM===a}).value();return c&&c.DICT_ITEM_NAME||""},getData:function(a){var b=[];for(var c in this)this.hasOwnProperty(c)&&(!a||this[c].ORG_CODE==a)&&b.push(this[c]);return b},isEmpty:function(){return!this.getData().length}}),e.extend({defaultDict:new d([]),get:function(a){return this[a]||this.getFirstVal(this)||this.defaultDict},getFirstVal:function(a){for(var b in a)return a[b]},size:function(){return _.keys(this).length}}),{getDictData:l,getDictDataObj:m,getDictText:i,refreshCache:k,transformDict:j}});